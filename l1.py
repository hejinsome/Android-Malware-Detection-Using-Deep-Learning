import numpy as np
import pandas as pd

df = pd.read_csv('features.csv')

all_api_calls_file = open('mixed_dataset/all_api_calls.txt')
all_api_calls = []
#column_names = []
for lines in all_api_calls_file.readlines():
	all_api_calls.append(lines[:-1])

f = open('l1.txt','w')
#L1
indexed_file = open('training_file_index','r')

target = []
count = 0
for row in indexed_file.readlines():
	#print(row)
	count = count + 1
	#print(count)
	components = row.split('-')
	name = components[0]
	if 'benign' in name:
		target.append(0)
	else :
		target.append(1)
print(target)
indexed_file.close()
from sklearn.svm import LinearSVC
from sklearn.feature_selection import SelectFromModel
lsvc = LinearSVC(C=0.01, penalty="l1", dual=False).fit(df, target)
model = SelectFromModel(lsvc, prefit=True)
X_new = model.transform(df)
print(X_new.shape)
print(model.get_support(indices=True))

selected_features = model.get_support(indices=True)

for a in selected_features:
	f.write(all_api_calls[a]+"\n")
f.close()	
	